<html ng-app="CurrencyExchange">
    <head>
    <title>TLD Currency Converter</title>
    <style>
    </style>
    <script src="/scripts/papaparse.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular.min.js"></script>
    <script src="/scripts/CurrencyExchange/CurrencyExchange.module.js"></script>
    <script src="/scripts/CurrencyExchange/services/ExchangeRate.service.js"></script>
    <script src="/scripts/CurrencyExchange/controllers/CurrencyExchange.controller.js"></script>
    </head>
    <body ng-controller="CurrencyExchangeController as Ctrl">
    <div ng-show="Ctrl.CurrencyState == 'initialized'">
        <form name="myForm">
            <table>
                <tr>
                    <td><label>From:</label></td>
                    <td><input type="text" ng-model="Ctrl.CurrencyFrom.Name" list="Currencies" placeholder="Enter Currencies Here" ng-change="Ctrl.UpdateExchangeRate()" autocomplete="off"/>
                        <label ng-show="Ctrl.CurrencyFrom.Validity() == 'empty'">*</label>
                        <label ng-show="Ctrl.CurrencyFrom.Validity() == 'invalid'">{{Ctrl.CurrencyFrom.Name}} is not a known currency</label>
                    </td>
                    <td ng-switch="Ctrl.CurrencyFrom.Validity()">
                    </td>
                </tr>
                <tr>
                  <td><label>To:</label></td>
                  <td><input type="text" ng-model="Ctrl.CurrencyTo.Name" list="Currencies" placeholder="Enter Currencies Here" ng-change="Ctrl.UpdateExchangeRate()" autocomplete="off"/>
                        <label ng-show="Ctrl.CurrencyTo.Validity() == 'empty'">*</label>
                        <label ng-show="Ctrl.CurrencyTo.Validity() == 'invalid'">{{Ctrl.CurrencyTo.Name}} is not a known currency</label>
                   </td>
                </tr>
                <tr>
                  <td><label>On:</label></td>
                  <td><input name="transactiondate" type="date" ng-model="Ctrl.TransactionDate" ng-change="Ctrl.UpdateExchangeRate()" required/>
                  <label ng-show="myForm.transactiondate.$error.required">*</label>
                  </td>
                </tr>
                <tr>
                  <td><label>Amounts:</label></td>
                  <td><textarea ng-model="Ctrl.UserAmounts" ng-change="Ctrl.UpdateAmounts()"></textarea></td>
                </tr>
            </table>
            <datalist id="Currencies">
                <option ng-repeat="currency in Ctrl.Currencies" value="{{currency}}">
            </datalist>
            <hr>
            <label ng-show="Ctrl.TransactionDate != null && Ctrl.CurrencyFrom.Validity() == 'valid' && Ctrl.CurrencyTo.Validity() == 'valid' && Ctrl.ExchangeRate">ExchangeRate is {{Ctrl.ExchangeRate}}</label>
            <label ng-show="Ctrl.TransactionDate != null && Ctrl.CurrencyFrom.Validity() == 'valid' && Ctrl.CurrencyTo.Validity() == 'valid' && !Ctrl.ExchangeRate">ExchangeRate is not available for {{Ctrl.TransactionDate.toDateString()}}</label>
            <table ng-show="Ctrl.ExchangeRate != null && Ctrl.Amounts.length != 0" border="1">
                <tr>
                    <th>{{Ctrl.CurrencyFrom.Name}}</th>
                    <th>{{Ctrl.CurrencyTo.Name}}</th>
                </tr>
                <tr ng-repeat='amount in Ctrl.Amounts track by $index'>
                    <th>{{amount}}</th>
                    <th>{{amount * Ctrl.ExchangeRate}}</th>
                </tr>
            </table>
        </form>
    </div>
    <div ng-show="Ctrl.CurrencyState == 'uninitialized'">Loading...</div>
    </body>
</html>

